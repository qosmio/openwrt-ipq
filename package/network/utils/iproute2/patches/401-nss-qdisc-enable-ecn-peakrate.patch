--- a/tc/q_nss.c
+++ b/tc/q_nss.c
@@ -433,8 +433,8 @@ struct qdisc_util nssbfifo_qdisc_util =
 
 static void nssfq_codel_explain(void)
 {
-	fprintf(stderr, "Usage: ... nssfq_codel target TIME interval TIME [ flows NUMBER ] [ quantum BYTES ]"
-				"[ limit PACKETS ] [ set_default ] [ accel_mode ]\n");
+	fprintf(stderr, "Usage: ... nssfq_codel target TIME interval TIME [ flows NUMBER ] [ quantum BYTES ] "
+				"[ limit PACKETS ] [ ecn | noecn ] [ set_default ] [ accel_mode ]\n");
 }
 
 static void nssfq_codel_explain_err1(void)
@@ -482,9 +482,9 @@ static int nssfq_codel_parse_opt(const s
 				return -1;
 			}
 		} else if (strcmp(*argv, "ecn") == 0) {
-			fprintf(stderr, "Illegal, ECN not supported\n");
-			nssfq_codel_explain();
-			return -1;
+			opt.ecn = 1;
+		} else if (strcmp(*argv, "noecn") == 0) {
+			opt.ecn = 0;
 		} else if (strcmp(*argv, "set_default") == 0) {
 			opt.set_default = 1;
 		} else if (strcmp(*argv, "accel_mode") == 0) {
@@ -738,7 +738,8 @@ struct qdisc_util nsscodel_qdisc_util =
 
 static void nsstbl_explain(void)
 {
-	fprintf(stderr, "Usage: ... nsstbl burst BYTES rate BPS [ mtu BYTES ] [ accel_mode ]\n");
+	fprintf(stderr, "Usage: ... nsstbl burst BYTES rate BPS [ peakrate BPS ]"
+				" [ mtu BYTES ] [ accel_mode ]\n");
 }
 
 static int nsstbl_parse_opt(const struct qdisc_util *qu, int argc, char **argv, struct nlmsghdr *n, const char *dev)
@@ -787,6 +788,17 @@ static int nsstbl_parse_opt(const struct
 				return -1;
 			}
 			ok++;
+		} else if (strcmp(*argv, "peakrate") == 0) {
+			NEXT_ARG();
+			if (opt.peakrate) {
+				fprintf(stderr, "Double \"peakrate\" spec\n");
+				return -1;
+			}
+			if (get_rate(&opt.peakrate, *argv)) {
+				fprintf(stderr, "Illegal \"peakrate\"\n");
+				return -1;
+			}
+			ok++;
 		} else if (strcmp(*argv, "accel_mode") == 0) {
 			NEXT_ARG();
 			if (get_u8(&opt.accel_mode, *argv, 0)) {
